<!DOCTYPE html> <html lang="es"> <head> <meta charset="UTF-8" /> <meta name="viewport"content="width=device-width, initial-scale=1.0"> <title>Reserva Sala White</title> <style> body { font-family: Arial, sans-serif; background: #f8f8f8; padding: 30px; color: #333; } form { max-width: 500px; margin: auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 0 10px rgba(0,0,0,0.1); } h2 { color: #00994d; /* Verde intenso */ text-align: center; } label { display: block; margin: 15px 0 5px; } input { width: 100%; padding: 10px; border: 1pxsolid #ccc; border-radius: 8px; } button { margin-top: 20px; width: 100%; padding: 12px; background-color: #00994d;color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; } button:hover { background-color: #007f3f; } .success, .error { text-align: center; margin-top: 20px; font-weight: bold; } .success { color: green; } .error {color: red; } </style> </head> <body> <form id="reservaForm"> <h2>Reserva Sala White</h2> <labelfor="name">Nombre / Name:</label> <input type="text" id="name" name="name" required /> <labelfor="email">Email:</label> <input type="email" id="email" name="email" required /> <label for="date">Fecha / Date:</label> <input type="date" id="date" name="date" required /> <label for="startTime">Hora de inicio / Start Time:</label> <input type="time" id="startTime" name="startTime" min="08:00" max="20:00" required /> <labelfor="endTime">Hora de fin / End Time:</label> <input type="time" id="endTime" name="endTime" min="08:00"max="20:00" required /> <input type="hidden" name="sala" value="Sala White"> <button type="submit">Reservar / Book</button> <p class="success" id="mensaje"></p> <p class="error" id="error"></p>  </form> <script> // ¡IMPORTANTE! Asegúrate de que esta URL sea la correcta de tu despliegue de Google Apps Script. const scriptURL = "https://script.google.com/macros/s/AKfycbwifd9DodOMDAXqsIBRvDRgEZsqjvzTdI8RU3Mut9Ci3bKayzzrcSyV2h1OeHIpiuLtMQ/exec"; // Aquí nos aseguramos de usar el ID correcto para el formulario y el nombre de los campos para el FormData const form = document.getElementById("reservaForm"); // Asegúrate que el ID del formulario coincide const mensaje = document.getElementById("mensaje"); const error = document.getElementById("error"); form.addEventListener("submit", async function(e) { console.log("¡Formulario enviado!"); // Esto debería aparecer ahora si todo funciona e.preventDefault(); // Obtener los valores de los campos por su 'name' (o 'id' si prefieres) const name = document.getElementById("name").value; const email = document.getElementById("email").value; const date = document.getElementById("date").value; const startTime = document.getElementById("startTime").value; const endTime = document.getElementById("endTime").value; const sala = "Sala White"; // Ya que no se envía desde un campo oculto con 'name', lo ponemos aquí mensaje.textContent = ""; error.textContent = "";  if (!scriptURL) { error.textContent = "❌ Error de configuración: La URL del Apps Script no está definida. Por favor, contacta al administrador.";console.error("scriptURL is not defined. Please set it after deploying Apps Script."); return; } // Validación de duración máxima de 2 horas const startDate = new Date(`1970-01-01T${startTime}:00`); const endDate = new Date(`1970-01-01T${endTime}:00`); const diff = (endDate - startDate) / (1000 * 60); if (diff <= 0 || diff > 120) { error.textContent = "❌ La duración debe ser de máximo 2 horas y la hora de fin debe ser posterior a la de inicio."; return; } const submitButton = form.querySelector('button[type="submit"]'); submitButton.disabled = true; submitButton.textContent = "Reservando...";// Preparar los datos para enviar al Apps Script (coinciden con los nombres que espera doPost) const data = { name: name,email: email, date: date, startTime: startTime, endTime: endTime, sala: sala // Incluimos la sala aquí }; try { constresponse = await fetch(scriptURL, { method: 'POST', body: JSON.stringify(data), headers: { 'Content-Type': 'application/json' } }); const contentType = response.headers.get("content-type"); if (contentType && contentType.indexOf("application/json") !== -1) { const result = await response.json(); if (result.result === "success") { mensaje.textContent = "✅ Reserva realizada con éxito!"; form.reset(); } else { error.textContent = "❌ Error al realizar la reserva: " + (result.message || "Error desconocido."); console.error("Error en Apps Script:", result.message); } } else {const textResult = await response.text(); error.textContent = "❌ Error inesperado del servidor. Código: " + response.status; console.error("Respuesta no JSON:", response.status, textResult); } } catch (fetchError) { error.textContent = "❌ Error de conexión. Por favor, inténtalo de nuevo más tarde o contacta al soporte.";console.error("Error de fetch:", fetchError); } finally { submitButton.disabled = false; submitButton.textContent = "Reservar / Book"; } }); </script> </body> </html>